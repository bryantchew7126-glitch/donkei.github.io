<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Manhwa Library</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: #0f0f0f;
      color: #fff;
    }
    header {
      background: linear-gradient(135deg, #ff0066, #6600ff);
      padding: 18px 0 14px 0;
      text-align: center;
      font-size: 28px;
      font-weight: bold;
      letter-spacing: 1px;
      color: white;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      margin-bottom: 0;
    }
    .navbar {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 20px;
      justify-content: center;
      align-items: center;
      background: #181824;
      padding: 10px 0 10px 0;
      border-bottom: 1.5px solid #260064;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .navbar select, .navbar input[type="text"], .navbar button {
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #222145;
      color: #fff;
      padding: 8px 12px;
      margin: 0 2px;
      outline: none;
      transition: box-shadow 0.15s, background 0.15s;
    }
    .navbar input[type="text"]:focus,
    .navbar select:focus {
      box-shadow: 0 0 4px #3d56d6;
      background: #252568;
    }
    .navbar button {
      cursor: pointer;
      background: linear-gradient(135deg, #ff0066, #6600ff);
      border: none;
      font-weight: 500;
      margin-left: 4px;
      margin-right: 4px;
    }
    .container {
      max-width: 1050px;
      margin: 0 auto;
      padding: 18px 8px;
    }
    .add-section {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      max-width: 430px;
      margin: 0 auto 22px auto;
      background: #191929;
      border-radius: 14px;
      padding: 18px 17px 15px 17px;
      box-shadow: 0 2px 10px #0002;
    }
    .add-section h3 {
      margin: 6px 0 13px 0;
      font-size: 18px;
      color: #ffb6ff;
    }
    .add-fields {
      display: flex;
      flex-wrap: wrap;
      gap: 18px 24px;
      width: 100%;
      margin-bottom: 18px;
    }
    .input-group {
      display: flex;
      flex-direction: column;
      flex: 1 1 110px;
      min-width: 110px;
    }
    .input-group label {
      margin-bottom: 3px;
      font-size: 15px;
      color: #cecefd;
      font-weight: 500;
      letter-spacing: 0.5px;
      padding-left: 1px;
    }
    .input-group input, .input-group select {
      padding: 9px;
      border-radius: 8px;
      border: none;
      font-size: 15px;
      background: #24244a;
      color: #fff;
      margin-bottom: 0;
    }
    .input-group input:focus,
    .input-group select:focus {
      outline: 2px solid #7c34f6;
      background: #28285a;
    }
    .add-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(90deg, #ff0066 36%, #6600ff 100%);
      color: #fff;
      border: none;
      border-radius: 10px;
      font-size: 20px;
      font-weight: 600;
      letter-spacing: 1.2px;
      margin-top: 10px;
      box-shadow: 0 3px 14px #6600ff28;
      cursor: pointer;
      transition: background 0.15s, transform 0.09s;
    }
    .add-btn:hover,
    .add-btn:focus {
      background: linear-gradient(90deg, #ff3385 20%, #8466ff 100%);
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 8px 18px #6600ff3a;
    }
    .cards-container {
      display: flex;
      flex-wrap: wrap;
      gap: 22px;
      justify-content: flex-start;
      padding-top: 8px;
    }
    .card {
      background: #1a1a1a;
      border-radius: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
      padding: 18px 16px 16px 16px;
      width: 248px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      position: relative;
      margin-bottom: 8px;
      transition: box-shadow 0.2s;
      cursor: pointer;
    }
    .card:hover {
      box-shadow: 0 6px 16px #6600ff50, 0 2px 8px rgba(0,0,0,0.5);
    }
    .card-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 10px;
      color: #ffccff;
      word-break: break-word;
    }
    .card-info {
      font-size: 15px;
      margin-bottom: 7px;
      color: #cccccc;
    }
    .card-actions {
      width: 100%;
      display: flex;
      gap: 8px;
      margin-top: 7px;
    }
    .card-actions button { pointer-events: all; }
    .status-btn {
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      margin-left: 4px;
      font-size: 15px;
      background: #444;
      transition: background 0.2s;
    }
    .status-completed { background: #15c560 !important; }
    .status-reading { background: #fd8002 !important; }
    .status-dropped { background: #de2626 !important; }
    .edit-btn {
      background: #009f44;
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      font-size: 14px;
    }
    .remove-btn {
      background: #bb2222;
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      font-size: 14px;
      margin-left: 0;
      transition: background 0.2s;
    }
    .remove-btn:hover { background: #ff3939; }
    #modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100vw; height: 100vh;
      background: rgba(18,10,35,0.9);
      justify-content: center;
      align-items: center;
    }
    #modal.show { display: flex; }
    #modal-content {
      background: #1a1840;
      padding: 32px 28px 22px 28px;
      border-radius: 15px;
      max-width: 95vw;
      min-width: 250px;
      color: #fafaff;
      box-shadow: 0 12px 50px #000a, 0 2px 8px #333c;
      font-size: 17px;
      position: relative;
      text-align: left;
      word-break: break-word;
      animation: modalShow .18s;
    }
    @keyframes modalShow {
      from { opacity: 0; transform: translateY(30px);}
      to   { opacity: 1; transform: translateY(0);}
    }
    #modal-content .close-btn {
      position: absolute; top: 10px; right: 13px;
      background: transparent; border: none; color: #ffb7ff;
      font-size: 27px; cursor: pointer; font-weight: bold;
      transition: color 0.15s;
    }
    #modal-content .close-btn:hover { color: #ff3386; }
    #modal-content h2 {
      margin-top: 0;
      margin-bottom: 0.5em;
      color: #e2c7ff;
    }
    @media (max-width: 700px) {
    .container {
      padding: 6px 2vw;
      max-width: 99vw;
    }

    /* NAVBAR: compact on mobile */
    .navbar {
      flex-direction: column;
      gap: 6px 0;
      padding: 6px 0 8px 0;
      box-shadow: 0 2px 8px #2222;
    }
    .navbar input[type="text"],
    .navbar select,
    .navbar button {
      width: 100%;
      max-width: 100%;
      font-size: 15px;
      padding: 7px 9px;
      margin: 0;
    }

    .add-section {
      padding: 12px 4vw;
      max-width: 99vw;
      border-radius: 9px;
      margin-bottom: 12px;
    }
    .add-fields {
      flex-direction: column;
      gap: 8px 0;
    }
    .input-group label {
      font-size: 15px;
      margin-bottom: 3px;
    }
    .input-group input,
    .input-group select {
      font-size: 16px;
      padding: 10px 8px;
      margin-bottom: 3px;
    }
    .add-btn {
      font-size: 20px;
      padding: 14px 10px;
      border-radius: 11px;
      margin-top: 12px;
    }

    .cards-container {
      align-items: center;   /* center the cards */
    }

    .card {
      width: 100%;
      max-width: 320px;      /* same as bars above for a clean column */
      border-radius: 11px;
      font-size: 17px;
      padding: 16px 16px 14px 16px;
      margin: 0 auto 10px auto;
      box-shadow: 0 4px 16px #4444;
    }
    .card-title { font-size: 21px; margin-bottom: 10px; }
    .card-info { font-size: 17px; margin-bottom: 6px; }
    .card-actions button {
      font-size: 16px;
      padding: 8px 10px;
      border-radius: 8px;
    }

    #modal-content {
      padding: 30px 6vw 25px 6vw;
      font-size: 18px;
      border-radius: 14px;
    }
    #modal-content button {
      font-size: 18px !important;
      padding: 11px 13px !important;
      border-radius: 8px !important;
    }
    #modal-content .close-btn { font-size: 30px; }
    /* Same max width for all navbar controls */
    #searchInput,
    #filterStatus,
    #sortDropdown {
      width: 100%;
      max-width: 320px;   /* change this value if you want narrower/wider */
      margin: 0 auto;     /* center each bar */
      display: block;
    }
  }

  </style>
</head>
<body>
<header>My Manhwa Library</header>
<nav class="navbar">
  <input type="text" id="searchInput" placeholder="Search manhwa..." onkeyup="searchManhwa()" />
  <select id="filterStatus" onchange="renderList()">
    <option value="All">All Statuses</option>
    <option value="Reading">Reading</option>
    <option value="Completed">Completed</option>
    <option value="Dropped">Dropped</option>
  </select>
  <select id="sortDropdown" onchange="sortManhwas()">
    <option value="az">Sort: A–Z</option>
    <option value="chaptersAsc">Sort: Chapters ↑</option>
    <option value="chaptersDesc">Sort: Chapters ↓</option>
    <option value="updated">Sort: Last Updated</option>
  </select>

</nav>
<div class="container">
  <div class="add-section">
    <h3>Add New Manhwa</h3>
    <div class="add-fields">
      <div class="input-group">
        <label for="newTitle">Title</label>
        <input type="text" id="newTitle" placeholder="Enter manhwa title" autocomplete="off" />
      </div>
      <div class="input-group">
        <label for="newChapters">Chapters</label>
        <input type="number" id="newChapters" placeholder="e.g. 85" min="0" />
      </div>
      <div class="input-group">
        <label for="newStatus">Status</label>
        <select id="newStatus">
          <option value="Reading">Reading</option>
          <option value="Completed">Completed</option>
          <option value="Dropped">Dropped</option>
        </select>
      </div>
    </div>
    <button class="add-btn" onclick="addManhwa()">Add to List</button>
  </div>
  <div id="manhwaCards" class="cards-container"></div>
</div>
<!-- Modal for card page view -->
<div id="modal"><div id="modal-content"></div></div>
<script>
  let manhwas = JSON.parse(localStorage.getItem('manhwas')) || [
    {title:"Solo leveling", chapters:0, status:"Reading"},
    {title:"Max-level newbie", chapters:162, status:"Reading"},
    {title:"Frenzy evolution", chapters:198, status:"Reading"},
    {title:"Super evolution", chapters:136, status:"Reading"},
    {title:"The beginning after the end", chapters:0, status:"Reading"},
    {title:"Player who can't level up", chapters:155, status:"Reading"},
    {title:"Archmage returns after 4000 years", chapters:189, status:"Reading"},
    {title:"Taming master", chapters:110, status:"Reading"},
    {title:"Nano machine", chapters:252, status:"Reading"},
    {title:"The game that I came from", chapters:0, status:"Reading"},
    {title:"Overgeared", chapters:220, status:"Reading"},
    {title:"66666 years: Advent of dark mage", chapters:100, status:"Reading"},
    {title:"Boundless necromancer", chapters:63, status:"Reading"},
    {title:"Return of disaster class hero", chapters:100, status:"Reading"},
    {title:"Crazy leveling system", chapters:106, status:"Reading"},
    {title:"Arcane sniper", chapters:186, status:"Reading"},
    {title:"Spirit sword sovereign", chapters:530, status:"Reading"},
    {title:"+99 reinforced wooden Stick", chapters:85, status:"Reading"},
    {title:"Druid of Seoul station", chapters:148, status:"Reading"},
    {title:"Transcension academy", chapters:80, status:"Reading"},
    {title:"Seoul station necromancer", chapters:145, status:"Reading"},
    {title:"Shadow hack", chapters:175, status:"Reading"},
    {title:"My path to killing gods", chapters:60, status:"Reading"},
    {title:"Disastrous necromancer", chapters:141, status:"Reading"},
    {title:"Absolute/All master necromancer", chapters:55, status:"Reading"},
    {title:"Heavenly demon instructor", chapters:105, status:"Reading"},
    {title:"Genius Necromancer", chapters:70, status:"Reading"},
    {title:"Kill the dragon", chapters:132, status:"Reading"},
    {title:"Astral pet store", chapters:167, status:"Reading"},
    {title:"Starting today I'm a player", chapters:103, status:"Reading"},
    {title:"Rise from the rubble", chapters:302, status:"Reading"},
    {title:"Constellation that returned from hell", chapters:160, status:"Reading"},
    {title:"Constellation are my disciple", chapters:84, status:"Reading"},
    {title:"Apocalyptic dungeon", chapters:204, status:"Reading"},
    {title:"Player who returned 10000 years later", chapters:133, status:"Reading"},
    {title:"Poison eating healer", chapters:50, status:"Reading"},
    {title:"SSS-class gacha hunter", chapters:91, status:"Reading"},
    {title:"Dungeon reset", chapters:193, status:"Reading"},
    {title:"Level up with skills", chapters:55, status:"Reading"},
    {title:"Sleeping ranker", chapters:105, status:"Reading"},
    {title:"Leveling up with gods", chapters:108, status:"Reading"},
    {title:"Farming in tower alone", chapters:52, status:"Reading"},
    {title:"Martial god regress to level 2", chapters:85, status:"Reading"},
    {title:"Warrior high school", chapters:51, status:"Reading"},
    {title:"Surviving as a mage", chapters:86, status:"Reading"},
    {title:"Return of the mount hua sect", chapters:117, status:"Reading"},
    {title:"Martial inverse", chapters:343, status:"Reading"},
    {title:"Battle god return", chapters:101, status:"Reading"},
    {title:"Logging in 10000 years into the future", chapters:108, status:"Reading"},
    {title:"Damn reincarnation", chapters:81, status:"Reading"},
    {title:"Infinite mage", chapters:65, status:"Reading"},
    {title:"The greatest estate developer", chapters:207, status:"Reading"},
    {title:"Regressed with king's power", chapters:54, status:"Reading"},
    {title:"Revenge of the iron-blooded hound", chapters:138, status:"Reading"},
    {title:"Second-life ranker", chapters:167, status:"Reading"},
    {title:"secretly cultivate for 1000 years", chapters:195, status:"Reading"},
    {title:"SSS rank lone summoner", chapters:56, status:"Reading"},
    {title:"Demon lord martial arts ascension", chapters:81, status:"Reading"},
    {title:"Assassin reincarnated as greatest swordsman", chapters:37, status:"Reading"},
    {title:"Existence", chapters:21, status:"Reading"},
    {title:"Demon evolution", chapters:89, status:"Reading"},
    {title:"Your talent is mine", chapters:106, status:"Reading"},
    {title:"Pick me up", chapters:97, status:"Reading"},
    {title:"Talent swallowing magician", chapters:76, status:"Reading"},
    {title:"Return of the shattered constellation", chapters:114, status:"Reading"},
    {title:"My school life pretending to be a worthless person", chapters:67, status:"Reading"},
    {title:"Han dae sung returned from hell", chapters:87, status:"Reading"},
    {title:"SSS class suicide hunter", chapters:83, status:"Reading"},
    {title:"Steel eating player", chapters:44, status:"Reading"},
    {title:"Son in low", chapters:277, status:"Reading"},
    {title:"Tutorial tower", chapters:198, status:"Reading"},
    {title:"Mr zombie", chapters:142, status:"Reading"},
    {title:"Climbing the tower even the regressor couldn't", chapters:44, status:"Reading"},
    {title:"max level player 100th regression", chapters:55, status:"Reading"},
    {title:"Monster pet evolution", chapters:323, status:"Reading"},
    {title:"Standard of reincarnation", chapters:125, status:"Reading"},
    {title:"Maxed strength stat necromancer", chapters:99, status:"Reading"},
    {title:"Demon king cheat system", chapters:49, status:"Reading"},
    {title:"Player breakout", chapters:150, status:"Reading"},
    {title:"Hero return", chapters:86, status:"Reading"},
    {title:"My daughter is the final boss", chapters:134, status:"Reading"},
    {title:"I don't really want to learn forbidden skills", chapters:97, status:"Reading"},
    {title:"I reply on my invincibility to deal tons of damage", chapters:55, status:"Reading"},
    {title:"I used to be a boss", chapters:91, status:"Reading"},
    {title:"Mr devourer please act like a final boss", chapters:54, status:"Reading"},
    {title:"Max-level player", chapters:65, status:"Reading"},
    {title:"Solo-bug player", chapters:120, status:"Reading"},
    {title:"Invincible at the start", chapters:118, status:"Reading"},
    {title:"My dad is too strong", chapters:166, status:"Reading"},
    {title:"Immortal emperor luo wu ji", chapters:248, status:"Reading"},
    {title:"Rise of the beast god", chapters:70, status:"Reading"},
    {title:"Taming spiritual female zombie", chapters:44, status:"Reading"},
    {title:"The Regressed S-Class Adventurer's Quest Life", chapters:31, status:"Reading"},
    {title:"Reborn as a skeleton/moonslayer", chapters:30, status:"Reading"},
    {title:"Unrivaled in online game", chapters:17, status:"Reading"},
    {title:"I got the weakest class,dragon tamer", chapters:78, status:"Reading"},
    {title:"Fire force", chapters:304, status:"Reading"},
    {title:"Super Gene", chapters:170, status:"Reading"},
    {title:"Dragon master", chapters:356, status:"Reading"},
    {title:"From goblin to goblin god", chapters:42, status:"Reading"},
    {title:"Evolution begins with a big tree", chapters:309, status:"Reading"},
    {title:"Taming system", chapters:39, status:"Reading"},
    {title:"Beast Familiar for All", chapters:90, status:"Reading"},
    {title:"Insect overlord", chapters:38, status:"Reading"},
    {title:"Upgrade from wild monsters", chapters:76, status:"Reading"},
    {title:"Blink master", chapters:47, status:"Reading"},
    {title:"Blue lock", chapters:328, status:"Reading"},
    {title:"Perfect hybrid", chapters:102, status:"Reading"},
    {title:"Chronicle of the demon faction", chapters:101, status:"Reading"},
    {title:"Reincarnator", chapters:67, status:"Reading"},
    {title:"I obtained a mythic item", chapters:118, status:"Reading"},
    {title:"The extra is too powerful", chapters:76, status:"Reading"},
    {title:"The academy genius tamer", chapters:40, status:"Reading"},
    {title:"Last on earth", chapters:46, status:"Reading"},
    {title:"Swordmaster son", chapters:152, status:"Reading"},
    {title:"Lazy lord master the sword", chapters:138, status:"Reading"},
    {title:"World after the fall", chapters:168, status:"Reading"},
    {title:"Academy genius swordsman", chapters:90, status:"Reading"},
    {title:"Surviving the game as a barbarian", chapters:97, status:"Reading"},
    {title:"Infinite level in murim", chapters:228, status:"Reading"},
    {title:"Login murim", chapters:216, status:"Reading"},
    {title:"Heavenly demon reborn", chapters:252, status:"Reading"},
    {title:"The Reborn Young Lord Is an Assassin", chapters:68, status:"Reading"},
    {title:"F-rank fortune hunter", chapters:77, status:"Reading"},
    {title:"All str sorcerer", chapters:63, status:"Reading"},
    {title:"I Am the Descendant of the Divine Dragon", chapters:134, status:"Reading"},
    {title:"Reincarnated as a Genius Prodigy of a Prestigious Family", chapters:47, status:"Reading"},
    {title:"This Villainous Disciple Is Not The Holy Child", chapters:124, status:"Reading"},
    {title:"Genius assassin takes it all", chapters:70, status:"Reading"},
    {title:"My Master Only Breaks Through Every Time the Limit Is Reached", chapters:102, status:"Reading"},
    {title:"Scoring the Sacred Body of the Ancients from the Get-go", chapters:97, status:"Reading"},
    {title:"Myst, Might, Mayhem", chapters:71, status:"Reading"},
    {title:"Repeat of the drifting moon", chapters:94, status:"Reading"},
    {title:"Rebirth Of The Ultimate Master", chapters:414, status:"Reading"},
    {title:"Infinite Devouring", chapters:250, status:"Reading"},
    {title:"Legend of an Asura - The Poison Dragon", chapters:133, status:"Reading"},
    {title:"I Became a Renowned Family's Sword Prodigy", chapters:164, status:"Reading"},
    {title:"Villain to kill", chapters:184, status:"Reading"},
    {title:"Hero killer", chapters:222, status:"Reading"},
    {title:"Player hides his past", chapters:53, status:"Reading"},
    {title:"Beastmaster", chapters:16, status:"Reading"},
    {title:"Global Beast Tamer", chapters:21, status:"Reading"},
    {title:"Cosmic Heavenly Demon 3077", chapters:51, status:"Reading"},
    {title:"Dungeons Odyssey", chapters:124, status:"Reading"},
    {title:"Descended from Divinity", chapters:164, status:"Reading"},
    {title:"I Stole the First Ranker's Soul", chapters:100, status:"Reading"},
    {title:"Absolute Master of the Senate", chapters:85, status:"Reading"},
    {title:"Regressing As The Bastard Of The Sword Clan", chapters:59, status:"Reading"},
    {title:"Shadow of the Supreme", chapters:62, status:"Reading"},
    {title:"The Jobless Guy Who Has Come to Slay", chapters:171, status:"Reading"},
    {title:"Return of the Hound", chapters:75, status:"Reading"},
    {title:"Devil Summoner, I Am the Abyss Lord", chapters:22, status:"Reading"},
    {title:"Time-Limited Genius Dark Knight", chapters:107, status:"Reading"},
    {title:"Helmut: The Forsaken Child", chapters:99, status:"Reading"},
    {title:"Absolute Sword Sense", chapters:143, status:"Reading"},
    {title:"Reincarnation of the Hero Party's Grand Mage", chapters:94, status:"Reading"},
    {title:"Hunter Academy’s Strongest Battle God", chapters:40, status:"Reading"},
    {title:"Surviving the Academy", chapters:82, status:"Reading"},
    {title:"Return of the Mad Demon", chapters:165, status:"Reading"},
    {title:"Absolute Regression", chapters:59, status:"Reading"},
    {title:"Legend of the northern blade", chapters:202, status:"Reading"},
    {title:"Heavenly Grand Archive's Young Master", chapters:140, status:"Reading"},
    {title:"Absolute Reign", chapters:53, status:"Reading"},
    {title:"Reborn to be a Supreme Emperor", chapters:375, status:"Reading"},
    {title:"I Can Summon God", chapters:149, status:"Reading"},
    {title:"Chronicles of the Reincarnated Demon God", chapters:58, status:"Reading"},
    {title:"Invincible After Shocking My Empress Wife", chapters:86, status:"Reading"},
    {title:"Return of the War God", chapters:130, status:"Reading"},
    {title:"Best Teacher Baek", chapters:136, status:"Reading"},
    {title:"The executioner", chapters:51, status:"Reading"},
    {title:"The Dungeon Cleaning Life of a Once Genius Hunter", chapters:45, status:"Reading"},
    {title:"Auto Hunting With My Clones", chapters:167, status:"Reading"},
    {title:"The Illegitimate Who Devours Weapons", chapters:58, status:"Reading"},
    {title:"The Reincarnated King of Fists", chapters:107, status:"Reading"},
    {title:"Legendary spearman", chapters:181, status:"Reading"},
    {title:"Steel emperor", chapters:91, status:"Reading"}
  ];
function saveManhwas() {
  localStorage.setItem('manhwas', JSON.stringify(manhwas));
}
function getStatusClass(status) {
  if (status === 'Completed') return 'status-completed';
  if (status === 'Reading') return 'status-reading';
  if (status === 'Dropped') return 'status-dropped';
  return '';
}
function renderList() {
  const container = document.getElementById('manhwaCards');
  container.innerHTML = '';
  const filterStatus = document.getElementById('filterStatus')
    ? document.getElementById('filterStatus').value
    : 'All';
  const searchKeyword = document.getElementById('searchInput').value.toLowerCase();
  manhwas.forEach((item, index) => {
    if (filterStatus !== 'All' && item.status !== filterStatus) return;
    if (searchKeyword && !item.title.toLowerCase().includes(searchKeyword)) return;
    const card = document.createElement('div');
    card.className = 'card';
    const statusClass = getStatusClass(item.status);
    // Card click for modal page view
    card.onclick = function(e) {
      // Prevent modal open on button/select/input clicks
      if (e.target.closest("button,select,input")) return;
      showModal(item);
    };
    if (item._editing) {
      card.innerHTML = `
        <div class="card-title">${item.title}</div>
        <div class="card-info">
          Chapters: <input id="editChapters${index}" type="number" min="0" value="${item.chapters}" style="width:80px;" />
        </div>
        <div class="card-info">
          Status:
          <select id="editStatus${index}">
            <option value="Reading" ${item.status==="Reading"?"selected":""}>Reading</option>
            <option value="Completed" ${item.status==="Completed"?"selected":""}>Completed</option>
            <option value="Dropped" ${item.status==="Dropped"?"selected":""}>Dropped</option>
          </select>
        </div>
        <div class="card-info">Last updated: ${item.lastUpdated ? new Date(item.lastUpdated).toLocaleDateString() : '—'}</div>
        <div class="card-actions">
          <button onclick="saveEdit(${index});event.stopPropagation();" class="edit-btn">Save</button>
          <button onclick="cancelEdit(${index});event.stopPropagation();" class="remove-btn">Cancel</button>
        </div>
      `;
    } else {
      card.innerHTML = `
        <div class="card-title">${item.title}</div>
        <div class="card-info">Chapters: ${item.chapters}</div>
        <div class="card-info">
          Status:
          <button class="status-btn ${statusClass}" onclick="toggleStatus(${index});event.stopPropagation();">
            ${item.status || 'Reading'}
          </button>
        </div>
        <div class="card-info">Last updated: ${item.lastUpdated ? new Date(item.lastUpdated).toLocaleDateString() : '—'}</div>
        <div class="card-actions">
          <button class="edit-btn" onclick="editManhwa(${index});event.stopPropagation();">Edit</button>
          <button class="remove-btn" onclick="removeManhwa(${index});event.stopPropagation();">Remove</button>
        </div>
      `;
    }
    container.appendChild(card);
  });
}
function addManhwa() {
  const title = document.getElementById('newTitle').value.trim();
  const chapters = parseInt(document.getElementById('newChapters').value) || 0;
  const status = document.getElementById('newStatus').value;
  if (!title) return;
  const now = Date.now();
  const existing = manhwas.find(item => item.title.trim().toLowerCase() === title.toLowerCase());
  if (existing) {
    existing.chapters = chapters;
    existing.status = status;
    existing.lastUpdated = now;
    alert('Existing manhwa found. Updated chapters and status.');
  } else {
    manhwas.push({ title, chapters, status, lastUpdated: now });
  }
  saveManhwas();
  renderList();
  document.getElementById('newTitle').value = '';
  document.getElementById('newChapters').value = '';
}
function toggleStatus(index) {
  const now = Date.now();
  const cur = manhwas[index].status;
  if (cur === 'Completed') manhwas[index].status = 'Dropped';
  else if (cur === 'Dropped') manhwas[index].status = 'Reading';
  else manhwas[index].status = 'Completed';
  manhwas[index].lastUpdated = now;
  saveManhwas();
  renderList();
}
function editManhwa(index) {
  manhwas[index]._editing = true;
  renderList();
  const el = document.getElementById(`editChapters${index}`);
  if (el) el.focus();
}
function saveEdit(index) {
  const card = document.getElementsByClassName('card')[index];
  const chapters = parseInt(card.querySelector(`#editChapters${index}`).value) || 0;
  const status = card.querySelector(`#editStatus${index}`).value;
  manhwas[index].chapters = chapters;
  manhwas[index].status = status;
  manhwas[index].lastUpdated = Date.now();
  delete manhwas[index]._editing;
  saveManhwas();
  renderList();
}
function cancelEdit(index) {
  delete manhwas[index]._editing;
  renderList();
}
function removeManhwa(index) {
  const confirmDelete = confirm(`Are you sure you want to remove "${manhwas[index].title}" from your library?`);
  if (!confirmDelete) return;
  manhwas.splice(index, 1);
  saveManhwas();
  renderList();
}
function searchManhwa() { renderList(); }
function sortAlphabetical() {
  manhwas.sort((a, b) => a.title.localeCompare(b.title));
  saveManhwas();
  renderList();
}
function sortByChapters(asc = true) {
  manhwas.sort((a, b) => asc ? a.chapters - b.chapters : b.chapters - a.chapters);
  saveManhwas();
  renderList();
}
function sortByLastUpdated() {
  manhwas.sort((a, b) => (b.lastUpdated || 0) - (a.lastUpdated || 0));
  saveManhwas();
  renderList();
}
function sortManhwas() {
  const val = document.getElementById('sortDropdown').value;
  if (val === "az") {
    manhwas.sort((a, b) => a.title.localeCompare(b.title));
  } else if (val === "chaptersAsc") {
    manhwas.sort((a, b) => a.chapters - b.chapters);
  } else if (val === "chaptersDesc") {
    manhwas.sort((a, b) => b.chapters - a.chapters);
  } else if (val === "updated") {
    manhwas.sort((a, b) => (b.lastUpdated || 0) - (a.lastUpdated || 0));
  }
  saveManhwas();
  renderList();
}

function showModal(item) {
  const modal = document.getElementById('modal');
  const content = document.getElementById('modal-content');
  // Escape title (in case of ')
  const safeTitle = item.title.replace(/'/g,"\\'");
  content.innerHTML = `
    <button class="close-btn" onclick="closeModal()">&times;</button>
    <h2>${item.title}</h2>
    <div>Chapters: <b>${item.chapters}</b></div>
    <div>Status: <b>${item.status}</b></div>
    <div>Last updated: ${item.lastUpdated ? new Date(item.lastUpdated).toLocaleDateString() : '—'}</div>
    <br>
    <button class="edit-btn" style="margin-top:7px;" onclick="editThisFromModal('${safeTitle}'); closeModal();">Edit</button>
    <button class="remove-btn" style="margin-left:10px;" onclick="removeThisFromModal('${safeTitle}'); closeModal();">Remove</button>
  `;
  modal.classList.add('show');
  modal.style.display = 'flex';
}
function closeModal() {
  const modal = document.getElementById('modal');
  modal.classList.remove('show');
  setTimeout(()=>{ modal.style.display='none'; }, 175);
}
window.onclick = function(event) {
  const modal = document.getElementById('modal');
  if (event.target == modal) closeModal();
};
// Modal edit/remove support (find by title)
function editThisFromModal(title) {
  const index = manhwas.findIndex(item=>item.title===title);
  if(index !== -1) editManhwa(index);
}
function removeThisFromModal(title) {
  const index = manhwas.findIndex(item=>item.title===title);
  if(index !== -1) removeManhwa(index);
}
renderList();
</script>
</body>
</html>
